(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat"],{"169b":function(t,i,e){"use strict";var n={"[大笑]":{file:"emoji_0.png"},"[可爱]":{file:"emoji_01.png"},"[色]":{file:"emoji_02.png"},"[嘘]":{file:"emoji_03.png"},"[亲]":{file:"emoji_04.png"},"[呆]":{file:"emoji_05.png"},"[口水]":{file:"emoji_06.png"},"[汗]":{file:"emoji_145.png"},"[呲牙]":{file:"emoji_07.png"},"[鬼脸]":{file:"emoji_08.png"},"[害羞]":{file:"emoji_09.png"},"[偷笑]":{file:"emoji_10.png"},"[调皮]":{file:"emoji_11.png"},"[可怜]":{file:"emoji_12.png"},"[敲]":{file:"emoji_13.png"},"[惊讶]":{file:"emoji_14.png"},"[流感]":{file:"emoji_15.png"},"[委屈]":{file:"emoji_16.png"},"[流泪]":{file:"emoji_17.png"},"[嚎哭]":{file:"emoji_18.png"},"[惊恐]":{file:"emoji_19.png"},"[怒]":{file:"emoji_20.png"},"[酷]":{file:"emoji_21.png"},"[不说]":{file:"emoji_22.png"},"[鄙视]":{file:"emoji_23.png"},"[阿弥陀佛]":{file:"emoji_24.png"},"[奸笑]":{file:"emoji_25.png"},"[睡着]":{file:"emoji_26.png"},"[口罩]":{file:"emoji_27.png"},"[努力]":{file:"emoji_28.png"},"[抠鼻孔]":{file:"emoji_29.png"},"[疑问]":{file:"emoji_30.png"},"[怒骂]":{file:"emoji_31.png"},"[晕]":{file:"emoji_32.png"},"[呕吐]":{file:"emoji_33.png"},"[拜一拜]":{file:"emoji_160.png"},"[惊喜]":{file:"emoji_161.png"},"[流汗]":{file:"emoji_162.png"},"[卖萌]":{file:"emoji_163.png"},"[默契眨眼]":{file:"emoji_164.png"},"[烧香拜佛]":{file:"emoji_165.png"},"[晚安]":{file:"emoji_166.png"},"[强]":{file:"emoji_34.png"},"[弱]":{file:"emoji_35.png"},"[OK]":{file:"emoji_36.png"},"[拳头]":{file:"emoji_37.png"},"[胜利]":{file:"emoji_38.png"},"[鼓掌]":{file:"emoji_39.png"},"[握手]":{file:"emoji_200.png"},"[发怒]":{file:"emoji_40.png"},"[骷髅]":{file:"emoji_41.png"},"[便便]":{file:"emoji_42.png"},"[火]":{file:"emoji_43.png"},"[溜]":{file:"emoji_44.png"},"[爱心]":{file:"emoji_45.png"},"[心碎]":{file:"emoji_46.png"},"[钟情]":{file:"emoji_47.png"},"[唇]":{file:"emoji_48.png"},"[戒指]":{file:"emoji_49.png"},"[钻石]":{file:"emoji_50.png"},"[太阳]":{file:"emoji_51.png"},"[有时晴]":{file:"emoji_52.png"},"[多云]":{file:"emoji_53.png"},"[雷]":{file:"emoji_54.png"},"[雨]":{file:"emoji_55.png"},"[雪花]":{file:"emoji_56.png"},"[爱人]":{file:"emoji_57.png"},"[帽子]":{file:"emoji_58.png"},"[皇冠]":{file:"emoji_59.png"},"[篮球]":{file:"emoji_60.png"},"[足球]":{file:"emoji_61.png"},"[垒球]":{file:"emoji_62.png"},"[网球]":{file:"emoji_63.png"},"[台球]":{file:"emoji_64.png"},"[咖啡]":{file:"emoji_65.png"},"[啤酒]":{file:"emoji_66.png"},"[干杯]":{file:"emoji_67.png"},"[柠檬汁]":{file:"emoji_68.png"},"[餐具]":{file:"emoji_69.png"},"[汉堡]":{file:"emoji_70.png"},"[鸡腿]":{file:"emoji_71.png"},"[面条]":{file:"emoji_72.png"},"[冰淇淋]":{file:"emoji_73.png"},"[沙冰]":{file:"emoji_74.png"},"[生日蛋糕]":{file:"emoji_75.png"},"[蛋糕]":{file:"emoji_76.png"},"[糖果]":{file:"emoji_77.png"},"[葡萄]":{file:"emoji_78.png"},"[西瓜]":{file:"emoji_79.png"},"[光碟]":{file:"emoji_80.png"},"[手机]":{file:"emoji_81.png"},"[电话]":{file:"emoji_82.png"},"[电视]":{file:"emoji_83.png"},"[声音开启]":{file:"emoji_84.png"},"[声音关闭]":{file:"emoji_85.png"},"[铃铛]":{file:"emoji_86.png"},"[锁头]":{file:"emoji_87.png"},"[放大镜]":{file:"emoji_88.png"},"[灯泡]":{file:"emoji_89.png"},"[锤头]":{file:"emoji_90.png"},"[烟]":{file:"emoji_91.png"},"[炸弹]":{file:"emoji_92.png"},"[枪]":{file:"emoji_93.png"},"[刀]":{file:"emoji_94.png"},"[药]":{file:"emoji_95.png"},"[打针]":{file:"emoji_96.png"},"[钱袋]":{file:"emoji_97.png"},"[钞票]":{file:"emoji_98.png"},"[银行卡]":{file:"emoji_99.png"},"[手柄]":{file:"emoji_100.png"},"[麻将]":{file:"emoji_101.png"},"[调色板]":{file:"emoji_102.png"},"[电影]":{file:"emoji_103.png"},"[麦克风]":{file:"emoji_104.png"},"[耳机]":{file:"emoji_105.png"},"[音乐]":{file:"emoji_106.png"},"[吉他]":{file:"emoji_107.png"},"[火箭]":{file:"emoji_108.png"},"[飞机]":{file:"emoji_109.png"},"[火车]":{file:"emoji_110.png"},"[公交]":{file:"emoji_111.png"},"[轿车]":{file:"emoji_112.png"},"[出租车]":{file:"emoji_113.png"},"[警车]":{file:"emoji_114.png"},"[自行车]":{file:"emoji_115.png"}};for(var s in n);i["a"]=n},4668:function(t,i,e){"use strict";var n=e("4a0c"),s=e.n(n);s.a},"4a0c":function(t,i,e){},"5a96":function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"chat"},[e("div",{ref:"content",staticClass:"content"},t._l(t.historyMsgObj.msgs,function(i,n){return e("div",{key:n,staticClass:"msg-item"},[t.toUser.card.imAccount==i.fromNick?e("div",{class:{to:t.toUser.card.imAccount==i.fromNick}},[e("img",{attrs:{src:t.toUser.card.headImg,alt:""}}),"text"==i.type?e("div",{staticClass:"text",domProps:{innerHTML:t._s(i.strings)}}):t._e(),"image"==i.type?e("div",{staticClass:"image"},[e("img",{style:{width:i.file.w+"px",height:i.file.h+"px"},attrs:{src:i.file.url},on:{click:function(e){return t.previewImg(i.file.url)}}})]):t._e()]):t._e(),t.account==i.fromNick?e("div",{class:{from:t.account==i.fromNick}},["text"==i.type?e("div",{staticClass:"text",domProps:{innerHTML:t._s(i.strings)}}):t._e(),"image"==i.type?e("div",{staticClass:"image"},[e("img",{style:{width:i.file.w+"px",height:i.file.h+"px"},attrs:{src:i.file.url},on:{click:function(e){return t.previewImg(i.file.url)}}})]):t._e(),e("img",{attrs:{src:t.self.headImg,alt:""}})]):t._e()])}),0),e("div",{staticClass:"input-warp"},[e("div",{staticClass:"input-box"},[e("img",{attrs:{src:t.$imageUrl+"/chat_add.png"},on:{click:t.plusHandler}}),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputVal,expression:"inputVal"}],ref:"input",attrs:{type:"text",placeholder:"请输入..."},domProps:{value:t.inputVal},on:{blur:t.inputBlur,focus:t.inputFocus,input:function(i){i.target.composing||(t.inputVal=i.target.value)}}}),e("img",{attrs:{src:t.$imageUrl+"/chat_face.png"},on:{click:function(i){t.emojiFlag=!t.emojiFlag,t.setFlag=!1}}}),e("img",{staticStyle:{"margin-right":"0"},attrs:{src:t.$imageUrl+"/moment_send.png",alt:""},on:{click:t.send}})]),t.emojiFlag?e("div",{staticClass:"emojis"},t._l(t.emoji,function(i,n){return e("div",{key:n,on:{click:function(e){return t.inputEmoji(n,i)}}},[e("img",{attrs:{src:t.$emojiUrl+"/"+i.file,mode:""}})])}),0):t._e(),t.setFlag?e("div",{staticClass:"set"},[t.showhuashu?t._e():e("div",{staticClass:"flag-box"},[e("div",[e("input",{staticClass:"file",attrs:{type:"file",accept:"image/*",id:"file",value:""},on:{change:t.fileInput}}),e("img",{attrs:{src:t.$imageUrl+"/chat_photograph.png",alt:""}}),e("div",[t._v("相册")])]),e("div",{on:{click:function(i){t.showhuashu=!t.showhuashu}}},[e("img",{attrs:{src:t.$imageUrl+"/chat_reply.png",alt:""}}),e("div",[t._v("话术库")])]),e("div",{on:{click:function(i){return t.$router.push("/my/chat")}}},[e("img",{attrs:{src:t.$imageUrl+"/chat_settings.png",alt:""}}),e("div",[t._v("设置")])])]),t.showhuashu?e("div",{staticClass:"huashu"},[e("div",{staticClass:"huashu-box"},t._l(t.verbalList,function(i){return e("div",{key:i.id,staticClass:"huashu-item",on:{click:function(e){return t.gethuas(i.content)}}},[t._v("\n\t\t\t\t\t\t\t"+t._s(i.content)+"\n\t\t\t\t\t\t")])}),0),e("div",{staticClass:"huashu-back",on:{click:function(i){t.showhuashu=!1}}},[t._v("\n\t\t\t\t\t\t关闭\n\t\t\t\t\t")])]):t._e()]):t._e()])])},s=[],o=(e("a481"),e("4917"),e("a745")),a=e.n(o),l=e("169b"),c=e("8fcf"),r={data:function(){return{showhuashu:!1,self:this.$store.state.user,nim:this.$store.state.nim,inputVal:"",toUser:{},historyMsgObj:{},emojiFlag:!1,setFlag:!1,emoji:l["a"],inputFcous:!1,account:this.$store.state.user.imAccount,verbalList:[]}},created:function(){c["a"].$on("onmsg",this.onmsg)},mounted:function(){var t=this.$route.query.user;document.title=t.card.nikeName,"string"==typeof t?this.toUser=this.$store.state.toUser:(this.$store.commit("setToUser",t),this.toUser=t),this.getHistoryMsgs(),this.getSpeechcraft()},methods:{plusHandler:function(){this.setFlag=!this.setFlag,this.emojiFlag=!1,this.setFlag||(this.showhuashu=!1)},gethuas:function(t){var i=this;i.nim.sendText({scene:"p2p",to:this.toUser.card.imAccount,text:t,done:e});function e(t,e){i.pushMsg(e),i.messageNotity()}this.$nextTick(function(){document.body.scrollTop=9999999})},getSpeechcraft:function(){var t=this;axios.post(this.$apiConfig.verbalList,{content:""}).then(function(i){0==i.data.code&&(t.verbalList=i.data.data)})},fileInput:function(){var t=this;function i(i,e){t.pushMsg(e),t.setFlag=!1,t.messageNotity()}this.nim.sendFile({scene:"p2p",to:t.toUser.card.imAccount,type:"image",fileInput:"file",done:i})},onmsg:function(t){(t.from==this.account&&t.to==this.toUser.card.imAccount||t.to==this.account&&t.from==this.toUser.card.imAccount)&&this.pushMsg(t)},inputEmoji:function(t,i){this.inputVal=this.inputVal+t},inputFocus:function(){this.emojiFlag=!1,this.setFlag=!1,setTimeout(function(){document.body.scrollTop=999999},100)},scrollToBottom:function(){var t=this;setTimeout(function(){t.$refs.content.scrollTop=9999999},200)},getHistoryMsgs:function(){var t=this;function i(i,e){e&&(e.msgs.map(function(i){"text"==i.type&&(i.strings=t.buildEmoji(i.text))}),t.historyMsgObj=e,t.$nextTick(function(){t.scrollToBottom()}))}t.nim.getHistoryMsgs({scene:"p2p",to:this.toUser.card.imAccount,asc:!0,done:i})},send:function(){this.$refs.input.blur(),this.emojiFlag=!1;var t=this;t.nim.sendText({scene:"p2p",to:this.toUser.card.imAccount,text:this.inputVal,done:i});function i(i,e){t.pushMsg(e),t.inputVal="",t.messageNotity()}},messageNotity:function(){var t={formUserId:this.self.id,toUserId:this.toUser.card.clientId};axios.post(this.$apiConfig.messageNotity,t).then(function(t){0==t.data.code&&console.log("推送成功")})},pushMsg:function(t){var i=this;a()(t)||(t=[t]),t.map(function(t){"text"==t.type&&(t.strings=i.buildEmoji(t.text))}),this.historyMsgObj.msgs=this.nim.mergeMsgs(this.historyMsgObj.msgs,t),this.$nextTick(function(){i.scrollToBottom()})},inputBlur:function(){document.body.scrollTop=0},buildEmoji:function(t){for(var i=/\[([^\]\[]*)\]/g,e=t.match(i)||[],n=0,s=e.length;n<s;++n)l["a"][e[n]]&&(t=t.replace(e[n],'<img class="emoji" style="width: .66667rem;height: .66667rem;" src="'.concat(this.$emojiUrl,"/").concat(l["a"][e[n]].file,'" />')));return t},previewImg:function(t){this.$createImagePreview({imgs:[t]}).show()}}},m=r,g=(e("877a"),e("2877")),u=Object(g["a"])(m,n,s,!1,null,"41045e82",null);i["default"]=u.exports},"877a":function(t,i,e){"use strict";var n=e("e82f"),s=e.n(n);s.a},e1a7:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"chat"},[e("div",{ref:"content",staticClass:"content"},[e("div",{staticClass:"title"},[t._v("你将发消息给"+t._s(t.group.length)+"位客户")]),e("div",{staticClass:"list"},[t._v("\n\t\t\t\t"+t._s(t.groupStr)+"\n\t\t\t")])]),e("div",{staticClass:"input-warp"},[e("div",{staticClass:"input-box"},[e("img",{attrs:{src:t.$imageUrl+"/chat_add.png"},on:{click:t.plusHandler}}),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputVal,expression:"inputVal"}],ref:"input",attrs:{type:"text",placeholder:"请输入..."},domProps:{value:t.inputVal},on:{blur:t.inputBlur,focus:t.inputFocus,input:function(i){i.target.composing||(t.inputVal=i.target.value)}}}),e("img",{attrs:{src:t.$imageUrl+"/chat_face.png"},on:{click:function(i){t.emojiFlag=!t.emojiFlag,t.setFlag=!1}}}),e("img",{staticStyle:{"margin-right":"0"},attrs:{src:t.$imageUrl+"/moment_send.png",alt:""},on:{click:t.send}})]),t.emojiFlag?e("div",{staticClass:"emojis"},t._l(t.emoji,function(i,n){return e("div",{key:n,on:{click:function(e){return t.inputEmoji(n,i)}}},[e("img",{attrs:{src:t.$emojiUrl+"/"+i.file,mode:""}})])}),0):t._e(),t.setFlag?e("div",{staticClass:"set"},[t.showhuashu?t._e():e("div",{staticClass:"flag-box"},[e("div",[e("input",{staticClass:"file",attrs:{type:"file",accept:"image/*",id:"file",value:""},on:{change:t.fileInput}}),e("img",{attrs:{src:t.$imageUrl+"/chat_photograph.png",alt:""}}),e("div",[t._v("相册")])]),e("div",{on:{click:function(i){t.showhuashu=!t.showhuashu}}},[e("img",{attrs:{src:t.$imageUrl+"/chat_reply.png",alt:""}}),e("div",[t._v("话术库")])]),e("div",{on:{click:function(i){return t.$router.push("/my/chat")}}},[e("img",{attrs:{src:t.$imageUrl+"/chat_settings.png",alt:""}}),e("div",[t._v("设置")])])]),t.showhuashu?e("div",{staticClass:"huashu"},[e("div",{staticClass:"huashu-box"},t._l(t.verbalList,function(i){return e("div",{key:i.id,staticClass:"huashu-item",on:{click:function(e){return t.gethuas(i.content)}}},[t._v("\n\t\t\t\t\t\t\t"+t._s(i.content)+"\n\t\t\t\t\t\t")])}),0),e("div",{staticClass:"huashu-back",on:{click:function(i){t.showhuashu=!1}}},[t._v("\n\t\t\t\t\t\t关闭\n\t\t\t\t\t")])]):t._e()]):t._e()])])},s=[],o=(e("4917"),e("a745")),a=e.n(o),l=(e("a481"),e("ac6a"),e("169b")),c=e("8fcf"),r={data:function(){return{group:[],groupStr:"",showhuashu:!1,self:this.$store.state.user,nim:this.$store.state.nim,inputVal:"",toUser:{},historyMsgObj:{},emojiFlag:!1,setFlag:!1,emoji:l["a"],inputFcous:!1,account:this.$store.state.user.imAccount,verbalList:[]}},created:function(){this.getSpeechcraft(),this.getGroup(),c["a"].$on("onmsg",this.onmsg)},mounted:function(){},methods:{plusHandler:function(){this.setFlag=!this.setFlag,this.emojiFlag=!1,this.setFlag||(this.showhuashu=!1)},getGroup:function(){this.group=this.$store.state.group;var t=this.group.map(function(t){return t.nikeName});this.groupStr=t.join("、")},gethuas:function(t){var i=this;function e(t,e){i.pushMsg(e)}this.group.forEach(function(n){i.nim.sendText({scene:"p2p",to:n.imAccount,text:t,done:e}),i.messageNotity(n.clientId)}),this.$router.replace("/address-book/message")},getSpeechcraft:function(){var t=this;axios.post(this.$apiConfig.verbalList,{content:""}).then(function(i){0==i.data.code&&(t.verbalList=i.data.data)})},messageNotity:function(t){var i={formUserId:this.self.id,toUserId:t};axios.post(this.$apiConfig.messageNotity,i).then(function(t){0==t.data.code&&console.log("推送成功")})},fileInput:function(){var t=this,i=this;function e(t,e){i.pushMsg(e),i.setFlag=!1}this.group.forEach(function(i){t.nim.sendFile({scene:"p2p",to:i.imAccount,type:"image",fileInput:"file",done:e}),t.messageNotity(i.clientId)}),this.$router.replace("/address-book/message")},onmsg:function(t){(t.from==this.account&&t.to==this.toUser.to||t.to==this.account&&t.from==this.toUser.to)&&this.pushMsg(t)},inputEmoji:function(t,i){this.inputVal=this.inputVal+t},inputFocus:function(){this.emojiFlag=!1,this.setFlag=!1,setTimeout(function(){document.body.scrollTop=999999},100);var t=this.$refs.input,i=this.inputVal.length;if(document.selection){var e=t.createTextRange();e.moveStart("character",i),e.collapse(),e.select()}else"number"===typeof t.selectionStart&&"number"===typeof t.selectionEnd&&(t.selectionStart=t.selectionEnd=i)},scrollToBottom:function(){},send:function(){var t=this;this.$refs.input.blur(),this.emojiFlag=!1;var i=this;function e(t,e){i.pushMsg(e),i.inputVal=""}this.group.forEach(function(n){i.nim.sendText({scene:"p2p",to:n.imAccount,text:t.inputVal,done:e}),i.messageNotity(n.clientId)}),this.$router.replace("/address-book/message")},pushMsg:function(t){var i=this;a()(t)||(t=[t]),t.map(function(t){"text"==t.type&&(t.strings=i.buildEmoji(t.text))}),this.historyMsgObj.msgs=this.nim.mergeMsgs(this.historyMsgObj.msgs,t)},inputBlur:function(){document.body.scrollTop=0},buildEmoji:function(t){for(var i=/\[([^\]\[]*)\]/g,e=t.match(i)||[],n=0,s=e.length;n<s;++n)l["a"][e[n]]&&(t=t.replace(e[n],'<img class="emoji" style="width: .66667rem;height: .66667rem;" src="'.concat(this.$emojiUrl,"/").concat(l["a"][e[n]].file,'" />')));return t}}},m=r,g=(e("4668"),e("2877")),u=Object(g["a"])(m,n,s,!1,null,"c79f0324",null);i["default"]=u.exports},e82f:function(t,i,e){}}]);
//# sourceMappingURL=chat.2d093365.js.map